{
  "model_name": "Network_Sessions",
  "version": "1.0.0",
  "objects": [
    {
      "name": "All_Sessions",
      "tags": [["network", "session"]],
      "search_constraints": "tag=network tag=session",
      "fields_cluster": [],
      "fields": [
        {
          "name": "action",
          "type": "required",
          "expected_values": ["added", "blocked"],
          "comment": "The action taken by the reporting device."
        },
        {
          "name": "dest_ip",
          "type": "required",
          "comment": "The internal IP address allocated to the client initializing a network session. For DHCP and VPN events, this is the IP address leased to the client."
        },
        {
          "name": "dest_mac",
          "type": "required",
          "comment": "The internal MAC address of the network session client. For DHCP events, this is the MAC address of the client acquiring an IP address lease. For VPN events, this is the MAC address of the client initializing a network session.Note: Always force lower case on this field.Note: Always use colons instead of dashes, spaces, or no separator."
        },
        {
          "name": "signature",
          "type": "required",
          "comment": "An indication of the type of network session event."
        },
        {
          "name": "dest_priority",
          "type": "optional",
          "comment": "The priority of the destination."
        },
        {
          "name": "duration",
          "type": "optional",
          "validity": "if(isnum(duration),duration,null())",
          "comment": "The amount of time for the completion of the network session event, in seconds."
        },
        {
          "name": "response_time",
          "type": "optional",
          "validity": "if(isnum(response_time),response_time,null())",
          "comment": "The amount of time it took to receive a response in the network session event, in seconds."
        },
        {
          "name": "src_dns",
          "type": "optional",
          "comment": "The external domain name of the client initializing a network session. Not applicable for DHCP events."
        },
        {
          "name": "src_mac",
          "type": "optional",
          "condition": "tag != dhcp",
          "comment": "The MAC address of the client initializing a network session. Not applicable for DHCP events.Note: Always force lower case on this field.Note: Always use colons instead of dashes, spaces, or no separator."
        },
        {
          "name": "vendor_product",
          "type": "optional",
          "comment": "The full name of the Dynamic Host Configuration Protocol (DHCP) or DNS server involved in this event including vendor and product name, such as Microsoft DHCP or ISC BIND. This field is generated by combining the values of the vendor and product fields."
        },
        {
          "name": "src_ip",
          "type": "conditional",
          "condition": "tag != dhcp",
          "comment": "The IP address of the client initializing a network session. Not applicable for DHCP events."
        },
        {
          "name": "user",
          "type": "required",
          "comment": "The user in a network session event, where applicable. For example, a VPN session or an authenticated DHCP event."
        }
      ],
      "child_dataset": [
        {
          "name": "Session_Start",
          "tags": [["network", "session", "start"]],
          "fields_cluster": [],
          "fields": [],
          "child_dataset": [],
          "search_constraints": "tag=start"
        },
        {
          "name": "Session_End",
          "tags": [["network", "session", "end"]],
          "fields_cluster": [],
          "fields": [],
          "child_dataset": [],
          "search_constraints": "tag=end"
        },
        {
          "name": "DHCP",
          "tags": [["network", "session", "dhcp"]],
          "fields_cluster": [],
          "fields": [
            {
              "name": "lease_duration",
              "type": "conditional",
              "condition": "lease_duration=*",
              "validity": "if(isnum(lease_duration),lease_duration,null())",
              "comment": "The duration of the Dynamic Host Configuration Protocol (DHCP) lease, in seconds."
            },
            {
              "name": "lease_scope",
              "type": "required",
              "comment": "The consecutive range of possible IP addresses that the Dynamic Host Configuration Protocol (DHCP) server can lease to clients on a subnet. A lease_scope typically defines a single physical subnet on your network to which DHCP services are offered."
            },
            {
              "name": "src_ip",
              "type": "not_allowed_in_search",
              "comment": "The IP address of the client initializing a network session. Not applicable for DHCP events."
            },
            {
              "name": "src_mac",
              "type": "not_allowed_in_search",
              "comment": "The MAC address of the client initializing a network session. Not applicable for DHCP events.Note: Always force lower case on this field.Note: Always use colons instead of dashes, spaces, or no separator."
            }
          ],
          "child_dataset": [],
          "search_constraints": "tag=dhcp"
        },
        {
          "name": "VPN",
          "tags": [["network", "session", "vpn"]],
          "fields_cluster": [],
          "fields": [],
          "child_dataset": [],
          "search_constraints": "tag=vpn"
        }
      ]
    }
  ]
}
