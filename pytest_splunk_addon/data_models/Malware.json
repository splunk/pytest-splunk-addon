{
  "model_name": "Malware",
  "version": "1.0.0",
  "objects": [
    {
      "name": "Malware Attacks",
      "tags": [["malware", "attack"]],
      "search_constraints": "tag=malware tag=attack",
      "fields_cluster": [],
      "fields": [
        {
          "name": "action",
          "type": "required",
          "expected_values": ["allowed", "blocked", "deferred"],
          "comment": "Action taken by the reporting device"
        },
        {
          "name": "category",
          "type": "required",
          "comment": "The category of the malware event, such as keylogger or ad-supported program."
        },
        {
          "name": "date",
          "type": "optional",
          "comment": "The date of the malware event."
        },
        {
          "name": "dest",
          "type": "required",
          "comment": "The system that was affected by the malware event. You can alias this from more specific fields, such as dest_host, dest_ip, or dest_name."
        },
        {
          "name": "dest_nt_domain",
          "type": "optional",
          "comment": "The NT domain of the destination, if applicable."
        },
        {
          "name": "dest_requires_av",
          "type": "optional",
          "comment": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons."
        },
        {
          "name": "file_hash",
          "type": "optional",
          "comment": "The hash of the file with suspected malware"
        },
        {
          "name": "file_name",
          "type": "required",
          "comment": "The name of the file with suspected malware"
        },
        {
          "name": "file_path",
          "type": "required",
          "comment": "The full file path of the file with suspected malware"
        },
        {
          "name": "severity",
          "type": "required",
          "expected_values": [
          "critical",
          "high",
          "medium",
          "low",
          "informational"
          ],
          "comment":"The severity of a message."
        },
        {
          "name": "severity_id",
          "type": "optional",
          "comment": "The numeric or vendor specific severity indicator corresponding to the event severity."
        },
        {
          "name": "signature",
          "type": "required",
          "comment": "The name of the malware infection detected on the client (the dest), such as Trojan.Vundo, Spyware.Gaobot, and W32.Nimbda"
        },
        {
          "name": "signature_id",
          "type": "optional",
          "comment": "The unique identifier or event code of the event signature."
        },
        {
          "name": "src",
          "type": "optional",
          "comment": "The source of the event, such as a DAT file relay server. You can alias this from more specific fields, such as src_host, src_ip, or src_name."
        },
        {
          "name": "src_user",
          "type": "optional",
          "comment": "The reported sender of an email-based attack."
        },
        {
          "name": "user",
          "type": "optional",
          "comment": "The user involved in the malware event."
        },
        {
          "name": "url",
          "type": "optional",
          "comment": "The hash of the file with suspected malware"
        },
        {
          "name": "vendor_product",
          "type": "required",
          "comment": "The hash of the file with suspected malware"
        }
      ],
      "child_dataset": [
        {
          "name": "Allowed Malware",
          "tags": [["malware", "attack"]],
          "fields_cluster": [],
          "search_constraints": "action=\"allowed\"",
          "fields": [],
          "child_dataset": []
        },
        {
          "name": "Blocked Malware",
          "tags": [["malware", "attack"]],
          "fields_cluster": [],
          "search_constraints": "action=\"blocked\"",
          "fields": [],
          "child_dataset": []
        },
        {
          "name": "Quarantined Malware",
          "tags": [["malware", "attack"]],
          "fields_cluster": [],
          "search_constraints": "action=\"deferred\"",
          "fields": [],
          "child_dataset": []
        }
      ]
    },
    {
      "name": "Malware Operations",
      "tags": [["malware", "operations"]],
      "search_constraints": "tag=malware tag=operations | tags outputfield=tag",
      "fields_cluster": [],
      "fields": [
        {
          "name": "dest",
          "type": "required",
          "comment": "The system where the malware operations event occurred"
        },
        {
          "name": "dest_nt_domain",
          "type": "optional",
          "comment": "The NT domain of the dest system, if applicable."
        },
        {
          "name": "dest_requires_av",
          "type": "optional",
          "comment": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons."
        },
        {
          "name": "product_version",
          "type": "optional",
          "comment": "The product version of the malware operations product"
        },
        {
          "name": "signature_version",
          "type": "required",
          "comment": "The version of the malware signature bundle in a signature update operations event"
        },
        {
          "name": "vendor_product",
          "type": "required",
          "comment": "The vendor product name of the malware operations product."
        }
      ],
      "child_dataset": []
    }
  ]
}
