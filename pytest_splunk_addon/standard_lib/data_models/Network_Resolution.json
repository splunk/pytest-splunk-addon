{
  "model_name": "Network_Resolution",
  "version":"1.0.0",
  "objects": [{
    "name": "DNS",
    "tags": [
      [
        "network",
        "resolution",
        "dns"
      ]
    ],
    "fields_cluster": [],
    "fields": [{
        "name": "additional_answer_count",
        "type": "required",
        "validity": "if(isnum(additional_answer_count),additional_answer_count,null())",
        "comment": "Number of entries in the 'additional' section of the DNS message."
      },
      {
        "name": "answer",
        "type": "required",
        "multi_value": true,
        "comment": "Resolved address for the query."
      },
      {
        "name": "answer_count",
        "type": "required",
        "validity": "if(isnum(answer_count) and answer_count == mvcount(answer),answer_count,null())",
        "comment": "Number of entries in the answer section of the DNS message."
      },
      {
        "name": "authority_answer_count",
        "type": "required",
        "validity": "if(isnum(authority_answer_count),authority_answer_count,null())",
        "comment": "Number of entries in the 'authority' section of the DNS message."
      },
      {
        "name": "dest",
        "type": "conditional",
        "condition": "(transport=\"HOPOPT\" OR transport=\"ICMP\" OR transport=\"IGMP\" OR transport=\"GGP\" OR transport=\"IP-in-IP\" OR transport=\"ST\" OR transport=\"TCP\" OR transport=\"CBT\" OR transport=\"EGP\" OR transport=\"IGP\" OR transport=\"BBN-RCC-MON\" OR transport=\"NVP-II\" OR transport=\"PUP\" OR transport=\"ARGUS\" OR transport=\"EMCON\" OR transport=\"XNET\" OR transport=\"CHAOS\" OR transport=\"UDP\" OR transport=\"MUX\" OR transport=\"DCN-MEAS\" OR transport=\"HMP\" OR transport=\"PRM\" OR transport=\"XNS-ID\" OR transport=\"TRUNK-1\" OR transport=\"TRUNK-2\" OR transport=\"LEAF-1\" OR transport=\"LEAF-2\" OR transport=\"RDP\" OR transport=\"IRTP\" OR transport=\"ISO-TP4\" OR transport=\"NETBLT\" OR transport=\"MFE-NSP\" OR transport=\"MERIT-INP\" OR transport=\"DCCP\" OR transport=\"3CP\" OR transport=\"IDPR\" OR transport=\"XTP\" OR transport=\"DDP\" OR transport=\"IDPR-CMTP\" OR transport=\"TP++\" OR transport=\"IL\" OR transport=\"IPv6\" OR transport=\"SDRP\" OR transport=\"IPv6-Route\" OR transport=\"IPv6-Frag\" OR transport=\"IDRP\" OR transport=\"RSVP\" OR transport=\"GREs\" OR transport=\"DSR\" OR transport=\"BNA\" OR transport=\"ESP\" OR transport=\"AH\" OR transport=\"I-NLSP\" OR transport=\"SwIPe\" OR transport=\"NARP\" OR transport=\"MOBILE\" OR transport=\"TLSP\" OR transport=\"SKIP\" OR transport=\"IPv6-ICMP\" OR transport=\"IPv6-NoNxt\" OR transport=\"IPv6-Opts\" OR transport=\"CFTP\" OR transport=\"SAT-EXPAK\" OR transport=\"KRYPTOLAN\" OR transport=\"RVD\" OR transport=\"IPPC\" OR transport=\"SAT-MON\" OR transport=\"VISA\" OR transport=\"IPCU\" OR transport=\"CPNX\" OR transport=\"CPHB\" OR transport=\"WSN\" OR transport=\"PVP\" OR transport=\"BR-SAT-MON\" OR transport=\"SUN-ND\" OR transport=\"WB-MON\" OR transport=\"WB-EXPAK\" OR transport=\"ISO-IP\" OR transport=\"VMTP\" OR transport=\"SECURE-VMTP\" OR transport=\"VINES\" OR transport=\"TTP\" OR transport=\"IPTM\" OR transport=\"NSFNET-IGP\" OR transport=\"DGP\" OR transport=\"TCF\" OR transport=\"EIGRP\" OR transport=\"OSPF\" OR transport=\"Sprite-RPC\" OR transport=\"LARP\" OR transport=\"MTP\" OR transport=\"AX.25\" OR transport=\"OS\" OR transport=\"MICP\" OR transport=\"SCC-SP\" OR transport=\"ETHERIP\" OR transport=\"ENCAP\" OR transport=\"GMTP\" OR transport=\"IFMP\" OR transport=\"PNNI\" OR transport=\"PIM\" OR transport=\"ARIS\" OR transport=\"SCPS\" OR transport=\"QNX\" OR transport=\"A/N\" OR transport=\"IPComp\" OR transport=\"SNP\" OR transport=\"Compaq-Peer\" OR transport=\"IPX-in-IP\" OR transport=\"VRRP\" OR transport=\"PGM\" OR transport=\"L2TP\" OR transport=\"DDX\" OR transport=\"IATP\" OR transport=\"STP\" OR transport=\"SRP\" OR transport=\"UTI\" OR transport=\"SMP\" OR transport=\"SM\" OR transport=\"PTP\" OR transport=\"IS-IS over IPv4\" OR transport=\"FIRE\" OR transport=\"CRTP\" OR transport=\"CRUDP\" OR transport=\"SSCOPMCE\" OR transport=\"IPLT\" OR transport=\"SPS\" OR transport=\"PIPE\" OR transport=\"SCTP\" OR transport=\"FC\" OR transport=\"RSVP-E2E-IGNORE\" OR transport=\"Mobility Header\" OR transport=\"UDPLite\" OR transport=\"MPLS-in-IP\" OR transport=\"manet\" OR transport=\"HIP\" OR transport=\"Shim6\" OR transport=\"WESP\" OR transport=\"ROHC\" OR transport=\"Ethernet\")",
        "comment": "The destination of the network resolution event. You can alias this from more specific fields, such as dest_host, dest_ip, or dest_name."
      },
      {
        "name": "message_type",
        "type": "required",
        "expected_values": [
          "Query",
          "Response"
        ],
        "comment": "Type of DNS message."
      },
      {
        "name": "query",
        "type": "required",
        "multi_value": true,
        "comment": "The domain which needs to be resolved. Applies to messages of type 'Query'."
      },
      {
        "name": "query_count",
        "type": "required",
        "validity": "if(isnum(query_count) and query_count == mvcount(query),query_count,null())",
        "comment": "Number of entries that appear in the 'Questions' section of the DNS query."
      },
      {
        "name": "query_type",
        "type": "required",
        "expected_values": [
          "Query",
          "IQuery",
          "Status",
          "Notify",
          "Update",
          "A",
          "MX",
          "NS",
          "PTR"
        ],
        "comment": "The field may contain DNS OpCodes or Resource Record Type codes. For details, see the Domain Name System Parameters on the Internet Assigned Numbers Authority (IANA) web site. If a value is not set, the DNS.record_type field is referenced."
      },
      {
        "name": "record_type",
        "type": "required",
        "expected_values": [
          "A",
          "DNAME",
          "MX",
          "NS",
          "PTR"
        ],
        "comment": "The DNS resource record type. For details, see the List of DNS record types on Wikipedia."
      },
      {
        "name": "reply_code",
        "type": "required",
        "expected_values": [
          "No Error",
          "Format Error",
          "Server Failure",
          "Non-Existent Domain",
          "NotImp",
          "Refused",
          "YXDomain",
          "YXRRSet",
          "NotAuth",
          "NotZone",
          "BADVERS",
          "BADSIG",
          "BADKEY",
          "BADTIME",
          "BADMODE",
          "BADNAME",
          "BADALG"
        ],
        "comment": "The return code for the response. For details, see the Domain Name System Parameters on the Internet Assigned Numbers Authority (IANA) web site."
      },
      {
        "name": "reply_code_id",
        "type": "required",
        "expected_values": [
          "No Error",
          "Format Error",
          "Server Failure",
          "Non-Existent Domain",
          "NotImp",
          "Refused",
          "YXDomain",
          "YXRRSet",
          "NotAuth",
          "NotZone",
          "BADVERS",
          "BADSIG",
          "BADKEY",
          "BADTIME",
          "BADMODE",
          "BADNAME",
          "BADALG",
          "0",
          "1",
          "2",
          "3"
        ],
        "comment": "The numerical id or name of a return code. For details, see the Domain Name System Parameters on the Internet Assigned Numbers Authority (IANA) web site."
      },
      {
        "name": "response_time",
        "type": "required",
        "validity": "if(isnum(response_time),response_time,null())",
        "comment": "The amount of time it took to receive a response in the network resolution event, in seconds."
      },
      {
        "name": "src",
        "type": "conditional",
        "condition": "(transport=\"HOPOPT\" OR transport=\"ICMP\" OR transport=\"IGMP\" OR transport=\"GGP\" OR transport=\"IP-in-IP\" OR transport=\"ST\" OR transport=\"TCP\" OR transport=\"CBT\" OR transport=\"EGP\" OR transport=\"IGP\" OR transport=\"BBN-RCC-MON\" OR transport=\"NVP-II\" OR transport=\"PUP\" OR transport=\"ARGUS\" OR transport=\"EMCON\" OR transport=\"XNET\" OR transport=\"CHAOS\" OR transport=\"UDP\" OR transport=\"MUX\" OR transport=\"DCN-MEAS\" OR transport=\"HMP\" OR transport=\"PRM\" OR transport=\"XNS-ID\" OR transport=\"TRUNK-1\" OR transport=\"TRUNK-2\" OR transport=\"LEAF-1\" OR transport=\"LEAF-2\" OR transport=\"RDP\" OR transport=\"IRTP\" OR transport=\"ISO-TP4\" OR transport=\"NETBLT\" OR transport=\"MFE-NSP\" OR transport=\"MERIT-INP\" OR transport=\"DCCP\" OR transport=\"3CP\" OR transport=\"IDPR\" OR transport=\"XTP\" OR transport=\"DDP\" OR transport=\"IDPR-CMTP\" OR transport=\"TP++\" OR transport=\"IL\" OR transport=\"IPv6\" OR transport=\"SDRP\" OR transport=\"IPv6-Route\" OR transport=\"IPv6-Frag\" OR transport=\"IDRP\" OR transport=\"RSVP\" OR transport=\"GREs\" OR transport=\"DSR\" OR transport=\"BNA\" OR transport=\"ESP\" OR transport=\"AH\" OR transport=\"I-NLSP\" OR transport=\"SwIPe\" OR transport=\"NARP\" OR transport=\"MOBILE\" OR transport=\"TLSP\" OR transport=\"SKIP\" OR transport=\"IPv6-ICMP\" OR transport=\"IPv6-NoNxt\" OR transport=\"IPv6-Opts\" OR transport=\"CFTP\" OR transport=\"SAT-EXPAK\" OR transport=\"KRYPTOLAN\" OR transport=\"RVD\" OR transport=\"IPPC\" OR transport=\"SAT-MON\" OR transport=\"VISA\" OR transport=\"IPCU\" OR transport=\"CPNX\" OR transport=\"CPHB\" OR transport=\"WSN\" OR transport=\"PVP\" OR transport=\"BR-SAT-MON\" OR transport=\"SUN-ND\" OR transport=\"WB-MON\" OR transport=\"WB-EXPAK\" OR transport=\"ISO-IP\" OR transport=\"VMTP\" OR transport=\"SECURE-VMTP\" OR transport=\"VINES\" OR transport=\"TTP\" OR transport=\"IPTM\" OR transport=\"NSFNET-IGP\" OR transport=\"DGP\" OR transport=\"TCF\" OR transport=\"EIGRP\" OR transport=\"OSPF\" OR transport=\"Sprite-RPC\" OR transport=\"LARP\" OR transport=\"MTP\" OR transport=\"AX.25\" OR transport=\"OS\" OR transport=\"MICP\" OR transport=\"SCC-SP\" OR transport=\"ETHERIP\" OR transport=\"ENCAP\" OR transport=\"GMTP\" OR transport=\"IFMP\" OR transport=\"PNNI\" OR transport=\"PIM\" OR transport=\"ARIS\" OR transport=\"SCPS\" OR transport=\"QNX\" OR transport=\"A/N\" OR transport=\"IPComp\" OR transport=\"SNP\" OR transport=\"Compaq-Peer\" OR transport=\"IPX-in-IP\" OR transport=\"VRRP\" OR transport=\"PGM\" OR transport=\"L2TP\" OR transport=\"DDX\" OR transport=\"IATP\" OR transport=\"STP\" OR transport=\"SRP\" OR transport=\"UTI\" OR transport=\"SMP\" OR transport=\"SM\" OR transport=\"PTP\" OR transport=\"IS-IS over IPv4\" OR transport=\"FIRE\" OR transport=\"CRTP\" OR transport=\"CRUDP\" OR transport=\"SSCOPMCE\" OR transport=\"IPLT\" OR transport=\"SPS\" OR transport=\"PIPE\" OR transport=\"SCTP\" OR transport=\"FC\" OR transport=\"RSVP-E2E-IGNORE\" OR transport=\"Mobility Header\" OR transport=\"UDPLite\" OR transport=\"MPLS-in-IP\" OR transport=\"manet\" OR transport=\"HIP\" OR transport=\"Shim6\" OR transport=\"WESP\" OR transport=\"ROHC\" OR transport=\"Ethernet\")",
        "comment": "The source of the network resolution event. You can alias this from more specific fields, such as src_host, src_ip, or src_name."
      },
      {
        "name": "transaction_id",
        "type": "required",
        "validity": "if(isnum(transaction_id),transaction_id,null())",
        "comment": "The unique numerical transaction id of the network resolution event"
      },
      {
        "name": "transport",
        "type": "required",
        "comment": "The transport protocol used by the network resolution event."
      },
      {
        "name": "duration",
        "type": "optional",
        "validity": "if(isnum(duration),duration,null())",
        "comment": "The time taken by the network resolution event, in seconds."
      },
      {
        "name": "name",
        "type": "optional",
        "comment": "The name of the DNS event."
      },
      {
        "name": "ttl",
        "type": "optional",
        "validity": "if(isnum(ttl),ttl,null())",
        "comment": "The time-to-live of the network resolution event, in seconds."
      },
      {
        "name": "vendor_product",
        "type": "optional",
        "comment": "The vendor product name of the DNS server. The Splunk platform can derive this field from the fields vendor and product in the raw data, if they exist."
      }
    ],
    "child_dataset": [],
    "search_constraints": "tag=network tag=resolution tag=dns"
  }]
}